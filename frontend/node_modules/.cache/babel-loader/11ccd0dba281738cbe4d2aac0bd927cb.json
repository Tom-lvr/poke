{"ast":null,"code":"import { useRef, useReducer, useEffect, createElement, useContext, useMemo, forwardRef, useState, useCallback } from 'react';\nimport { useId } from '@reach/auto-id';\nimport { Popover } from '@reach/popover';\nimport { createDescendantContext, useDescendantsInit, DescendantProvider, useDescendants, useDescendant, useDescendantKeyDown } from '@reach/descendants';\nimport { isRightClick } from '@reach/utils/is-right-click';\nimport { usePrevious } from '@reach/utils/use-previous';\nimport { getOwnerDocument } from '@reach/utils/owner-document';\nimport { createNamedContext } from '@reach/utils/context';\nimport { isFunction, isString } from '@reach/utils/type-check';\nimport { makeId } from '@reach/utils/make-id';\nimport { useStatefulRefValue } from '@reach/utils/use-stateful-ref-value';\nimport { useComposedRefs } from '@reach/utils/compose-refs';\nimport { composeEventHandlers } from '@reach/utils/compose-event-handlers';\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nvar _excluded = [\"onKeyDown\", \"onMouseDown\", \"id\", \"ref\"],\n    _excluded2 = [\"as\"],\n    _excluded3 = [\"index\", \"isLink\", \"onClick\", \"onDragStart\", \"onMouseDown\", \"onMouseEnter\", \"onMouseLeave\", \"onMouseMove\", \"onMouseUp\", \"onSelect\", \"disabled\", \"onFocus\", \"valueText\", \"ref\"],\n    _excluded4 = [\"as\"],\n    _excluded5 = [\"id\", \"onKeyDown\", \"ref\"],\n    _excluded6 = [\"as\"],\n    _excluded7 = [\"onBlur\", \"portal\", \"position\", \"ref\"],\n    _excluded8 = [\"as\"]; ////////////////////////////////////////////////////////////////////////////////\n// Actions\n\nvar CLEAR_SELECTION_INDEX = \"CLEAR_SELECTION_INDEX\";\nvar CLICK_MENU_ITEM = \"CLICK_MENU_ITEM\";\nvar CLOSE_MENU = \"CLOSE_MENU\";\nvar OPEN_MENU_AT_FIRST_ITEM = \"OPEN_MENU_AT_FIRST_ITEM\";\nvar OPEN_MENU_AT_INDEX = \"OPEN_MENU_AT_INDEX\";\nvar OPEN_MENU_CLEARED = \"OPEN_MENU_CLEARED\";\nvar SEARCH_FOR_ITEM = \"SEARCH_FOR_ITEM\";\nvar SELECT_ITEM_AT_INDEX = \"SELECT_ITEM_AT_INDEX\";\nvar SET_BUTTON_ID = \"SET_BUTTON_ID\";\nvar DropdownDescendantContext = /*#__PURE__*/createDescendantContext(\"DropdownDescendantContext\");\nvar DropdownContext = /*#__PURE__*/createNamedContext(\"DropdownContext\", {});\nvar initialState = {\n  // The button ID is needed for aria controls and can be set directly and\n  // updated for top-level use via context. Otherwise a default is set by useId.\n  // TODO: Consider deprecating direct ID in 1.0 in favor of id at the top level\n  //       for passing deterministic IDs to descendent components.\n  triggerId: null,\n  // Whether or not the dropdown is expanded\n  isExpanded: false,\n  // When a user begins typing a character string, the selection will change if\n  // a matching item is found\n  typeaheadQuery: \"\",\n  // The index of the current selected item. When the selection is cleared a\n  // value of -1 is used.\n  selectionIndex: -1\n}; ////////////////////////////////////////////////////////////////////////////////\n// Dropdown!\n\nvar DropdownProvider = function DropdownProvider(_ref) {\n  var id = _ref.id,\n      children = _ref.children;\n  var triggerRef = useRef(null);\n  var dropdownRef = useRef(null);\n  var popoverRef = useRef(null);\n\n  var _useDescendantsInit = useDescendantsInit(),\n      descendants = _useDescendantsInit[0],\n      setDescendants = _useDescendantsInit[1];\n\n  var _id = useId(id);\n\n  var dropdownId = id || makeId(\"menu\", _id);\n  var triggerId = makeId(\"menu-button\", dropdownId);\n\n  var _React$useReducer = useReducer(reducer, _extends({}, initialState, {\n    triggerId: triggerId\n  })),\n      state = _React$useReducer[0],\n      dispatch = _React$useReducer[1]; // We use an event listener attached to the window to capture outside clicks\n  // that close the dropdown. We don't want the initial button click to trigger\n  // this when a dropdown is closed, so we can track this behavior in a ref for\n  // now. We shouldn't need this when we rewrite with state machine logic.\n\n\n  var triggerClickedRef = useRef(false); // We will put children callbacks in a ref to avoid triggering endless render\n  // loops when using render props if the app code doesn't useCallback\n  // https://github.com/reach/reach-ui/issues/523\n\n  var selectCallbacks = useRef([]); // If the popover's position overlaps with an option when the popover\n  // initially opens, the mouseup event will trigger a select. To prevent that,\n  // we decide the control is only ready to make a selection if the pointer\n  // moves a certain distance OR if the mouse button is pressed for a certain\n  // length of time, otherwise the user is just registering the initial button\n  // click rather than selecting an item.\n  // For context on some implementation details, see https://github.com/reach/reach-ui/issues/563\n\n  var readyToSelect = useRef(false);\n  var mouseDownStartPosRef = useRef({\n    x: 0,\n    y: 0\n  }); // Trying a new approach for splitting up contexts by stable/unstable\n  // references. We'll see how it goes!\n\n  var context = {\n    dispatch: dispatch,\n    dropdownId: dropdownId,\n    dropdownRef: dropdownRef,\n    mouseDownStartPosRef: mouseDownStartPosRef,\n    popoverRef: popoverRef,\n    readyToSelect: readyToSelect,\n    selectCallbacks: selectCallbacks,\n    state: state,\n    triggerClickedRef: triggerClickedRef,\n    triggerRef: triggerRef\n  }; // When the dropdown is open, focus is placed on the dropdown itself so that\n  // keyboard navigation is still possible.\n\n  useEffect(function () {\n    if (state.isExpanded) {\n      // @ts-ignore\n      window.__REACH_DISABLE_TOOLTIPS = true;\n      window.requestAnimationFrame(function () {\n        focus(dropdownRef.current);\n      });\n    } else {\n      // We want to ignore the immediate focus of a tooltip so it doesn't pop up\n      // again when the dropdown closes, only pops up when focus returns again\n      // to the tooltip (like native OS tooltips).\n      // @ts-ignore\n      window.__REACH_DISABLE_TOOLTIPS = false;\n    }\n  }, [state.isExpanded]);\n  return /*#__PURE__*/createElement(DescendantProvider, {\n    context: DropdownDescendantContext,\n    items: descendants,\n    set: setDescendants\n  }, /*#__PURE__*/createElement(DropdownContext.Provider, {\n    value: context\n  }, isFunction(children) ? children({\n    isExpanded: state.isExpanded,\n    // TODO: Remove in 1.0\n    isOpen: state.isExpanded\n  }) : children));\n};\n\nif (process.env.NODE_ENV !== \"production\") {\n  DropdownProvider.displayName = \"DropdownProvider\";\n} ////////////////////////////////////////////////////////////////////////////////\n\n\nfunction useDropdownTrigger(_ref2) {\n  var onKeyDown = _ref2.onKeyDown,\n      onMouseDown = _ref2.onMouseDown,\n      id = _ref2.id,\n      forwardedRef = _ref2.ref,\n      props = _objectWithoutPropertiesLoose(_ref2, _excluded);\n\n  var _useDropdownContext = useDropdownContext(),\n      dispatch = _useDropdownContext.dispatch,\n      dropdownId = _useDropdownContext.dropdownId,\n      mouseDownStartPosRef = _useDropdownContext.mouseDownStartPosRef,\n      triggerClickedRef = _useDropdownContext.triggerClickedRef,\n      triggerRef = _useDropdownContext.triggerRef,\n      _useDropdownContext$s = _useDropdownContext.state,\n      triggerId = _useDropdownContext$s.triggerId,\n      isExpanded = _useDropdownContext$s.isExpanded;\n\n  var ref = useComposedRefs(triggerRef, forwardedRef);\n  var items = useDropdownDescendants();\n  var firstNonDisabledIndex = useMemo(function () {\n    return items.findIndex(function (item) {\n      return !item.disabled;\n    });\n  }, [items]);\n  useEffect(function () {\n    if (id != null && id !== triggerId) {\n      dispatch({\n        type: SET_BUTTON_ID,\n        payload: id\n      });\n    }\n  }, [triggerId, dispatch, id]);\n\n  function handleKeyDown(event) {\n    switch (event.key) {\n      case \"ArrowDown\":\n      case \"ArrowUp\":\n        event.preventDefault(); // prevent scroll\n\n        dispatch({\n          type: OPEN_MENU_AT_INDEX,\n          payload: {\n            index: firstNonDisabledIndex\n          }\n        });\n        break;\n\n      case \"Enter\":\n      case \" \":\n        dispatch({\n          type: OPEN_MENU_AT_INDEX,\n          payload: {\n            index: firstNonDisabledIndex\n          }\n        });\n        break;\n    }\n  }\n\n  function handleMouseDown(event) {\n    if (isRightClick(event.nativeEvent)) {\n      return;\n    }\n\n    mouseDownStartPosRef.current = {\n      x: event.clientX,\n      y: event.clientY\n    };\n\n    if (!isExpanded) {\n      triggerClickedRef.current = true;\n    }\n\n    if (isExpanded) {\n      dispatch({\n        type: CLOSE_MENU\n      });\n    } else {\n      dispatch({\n        type: OPEN_MENU_CLEARED\n      });\n    }\n  }\n\n  return {\n    data: {\n      isExpanded: isExpanded,\n      controls: dropdownId\n    },\n    props: _extends({}, props, {\n      ref: ref,\n      id: triggerId || undefined,\n      onKeyDown: composeEventHandlers(onKeyDown, handleKeyDown),\n      onMouseDown: composeEventHandlers(onMouseDown, handleMouseDown),\n      type: \"button\"\n    })\n  };\n}\n\nvar DropdownTrigger = /*#__PURE__*/forwardRef(function (_ref3, forwardedRef) {\n  var _ref3$as = _ref3.as,\n      Comp = _ref3$as === void 0 ? \"button\" : _ref3$as,\n      rest = _objectWithoutPropertiesLoose(_ref3, _excluded2);\n\n  var _useDropdownTrigger = useDropdownTrigger(_extends({}, rest, {\n    ref: forwardedRef\n  })),\n      props = _useDropdownTrigger.props;\n\n  return /*#__PURE__*/createElement(Comp, _extends({\n    \"data-reach-dropdown-trigger\": \"\"\n  }, props));\n});\n\nif (process.env.NODE_ENV !== \"production\") {\n  DropdownTrigger.displayName = \"DropdownTrigger\";\n} ////////////////////////////////////////////////////////////////////////////////\n\n\nfunction useDropdownItem(_ref4) {\n  var indexProp = _ref4.index,\n      _ref4$isLink = _ref4.isLink,\n      isLink = _ref4$isLink === void 0 ? false : _ref4$isLink,\n      onClick = _ref4.onClick,\n      onDragStart = _ref4.onDragStart,\n      onMouseDown = _ref4.onMouseDown,\n      onMouseEnter = _ref4.onMouseEnter,\n      onMouseLeave = _ref4.onMouseLeave,\n      onMouseMove = _ref4.onMouseMove,\n      onMouseUp = _ref4.onMouseUp,\n      onSelect = _ref4.onSelect,\n      disabled = _ref4.disabled,\n      onFocus = _ref4.onFocus,\n      valueTextProp = _ref4.valueText,\n      forwardedRef = _ref4.ref,\n      props = _objectWithoutPropertiesLoose(_ref4, _excluded3);\n\n  var _useDropdownContext2 = useDropdownContext(),\n      dispatch = _useDropdownContext2.dispatch,\n      dropdownRef = _useDropdownContext2.dropdownRef,\n      mouseDownStartPosRef = _useDropdownContext2.mouseDownStartPosRef,\n      readyToSelect = _useDropdownContext2.readyToSelect,\n      selectCallbacks = _useDropdownContext2.selectCallbacks,\n      triggerRef = _useDropdownContext2.triggerRef,\n      _useDropdownContext2$ = _useDropdownContext2.state,\n      selectionIndex = _useDropdownContext2$.selectionIndex,\n      isExpanded = _useDropdownContext2$.isExpanded;\n\n  var ownRef = useRef(null); // After the ref is mounted to the DOM node, we check to see if we have an\n  // explicit valueText prop before looking for the node's textContent for\n  // typeahead functionality.\n\n  var _React$useState = useState(valueTextProp || \"\"),\n      valueText = _React$useState[0],\n      setValueText = _React$useState[1];\n\n  var setValueTextFromDOM = useCallback(function (node) {\n    if (!valueTextProp && node != null && node.textContent) {\n      setValueText(node.textContent);\n    }\n  }, [valueTextProp]);\n  var mouseEventStarted = useRef(false);\n\n  var _useStatefulRefValue = useStatefulRefValue(ownRef, null),\n      element = _useStatefulRefValue[0],\n      handleRefSet = _useStatefulRefValue[1];\n\n  var descendant = useMemo(function () {\n    return {\n      element: element,\n      key: valueText,\n      disabled: disabled,\n      isLink: isLink\n    };\n  }, [disabled, element, isLink, valueText]);\n  var index = useDescendant(descendant, DropdownDescendantContext, indexProp);\n  var isSelected = index === selectionIndex && !disabled;\n  var ref = useComposedRefs(forwardedRef, handleRefSet, setValueTextFromDOM); // Update the callback ref array on every render\n\n  selectCallbacks.current[index] = onSelect;\n\n  function select() {\n    focus(triggerRef.current);\n    onSelect && onSelect();\n    dispatch({\n      type: CLICK_MENU_ITEM\n    });\n  }\n\n  function handleClick(event) {\n    if (isRightClick(event.nativeEvent)) {\n      return;\n    }\n\n    if (isLink) {\n      if (disabled) {\n        event.preventDefault();\n      } else {\n        select();\n      }\n    }\n  }\n\n  function handleDragStart(event) {\n    // Because we don't preventDefault on mousedown for links (we need the\n    // native click event), clicking and holding on a link triggers a\n    // dragstart which we don't want.\n    if (isLink) {\n      event.preventDefault();\n    }\n  }\n\n  function handleMouseDown(event) {\n    if (isRightClick(event.nativeEvent)) {\n      return;\n    }\n\n    if (isLink) {\n      // Signal that the mouse is down so we can call the right function if the\n      // user is clicking on a link.\n      mouseEventStarted.current = true;\n    } else {\n      event.preventDefault();\n    }\n  }\n\n  function handleMouseEnter(event) {\n    var doc = getOwnerDocument(dropdownRef.current);\n\n    if (!isSelected && index != null && !disabled) {\n      if (dropdownRef != null && dropdownRef.current && dropdownRef.current !== doc.activeElement && ownRef.current !== doc.activeElement) {\n        dropdownRef.current.focus();\n      }\n\n      dispatch({\n        type: SELECT_ITEM_AT_INDEX,\n        payload: {\n          index: index\n        }\n      });\n    }\n  }\n\n  function handleMouseLeave(event) {\n    // Clear out selection when mouse over a non-dropdown-item child.\n    dispatch({\n      type: CLEAR_SELECTION_INDEX\n    });\n  }\n\n  function handleMouseMove(event) {\n    if (!readyToSelect.current) {\n      var threshold = 8;\n      var deltaX = Math.abs(event.clientX - mouseDownStartPosRef.current.x);\n      var deltaY = Math.abs(event.clientY - mouseDownStartPosRef.current.y);\n\n      if (deltaX > threshold || deltaY > threshold) {\n        readyToSelect.current = true;\n      }\n    }\n\n    if (!isSelected && index != null && !disabled) {\n      dispatch({\n        type: SELECT_ITEM_AT_INDEX,\n        payload: {\n          index: index,\n          dropdownRef: dropdownRef\n        }\n      });\n    }\n  }\n\n  function handleFocus() {\n    readyToSelect.current = true;\n\n    if (!isSelected && index != null && !disabled) {\n      dispatch({\n        type: SELECT_ITEM_AT_INDEX,\n        payload: {\n          index: index\n        }\n      });\n    }\n  }\n\n  function handleMouseUp(event) {\n    if (isRightClick(event.nativeEvent)) {\n      return;\n    }\n\n    if (!readyToSelect.current) {\n      readyToSelect.current = true;\n      return;\n    }\n\n    if (isLink) {\n      // If a mousedown event was initiated on a link item followed by a mouseup\n      // event on the same link, we do nothing; a click event will come next and\n      // handle selection. Otherwise, we trigger a click event.\n      if (mouseEventStarted.current) {\n        mouseEventStarted.current = false;\n      } else if (ownRef.current) {\n        ownRef.current.click();\n      }\n    } else {\n      if (!disabled) {\n        select();\n      }\n    }\n  }\n\n  useEffect(function () {\n    if (isExpanded) {\n      // When the dropdown opens, wait for about half a second before enabling\n      // selection. This is designed to mirror dropdown menus on macOS, where\n      // opening a menu on top of a trigger would otherwise result in an\n      // immediate accidental selection once the click trigger is released.\n      var id = window.setTimeout(function () {\n        readyToSelect.current = true;\n      }, 400);\n      return function () {\n        window.clearTimeout(id);\n      };\n    } else {\n      // When the dropdown closes, reset readyToSelect for the next interaction.\n      readyToSelect.current = false;\n    }\n  }, [isExpanded, readyToSelect]); // Any time a mouseup event occurs anywhere in the document, we reset the\n  // mouseEventStarted ref so we can check it again when needed.\n\n  useEffect(function () {\n    var ownerDocument = getOwnerDocument(ownRef.current);\n    ownerDocument.addEventListener(\"mouseup\", listener);\n    return function () {\n      ownerDocument.removeEventListener(\"mouseup\", listener);\n    };\n\n    function listener() {\n      mouseEventStarted.current = false;\n    }\n  }, []);\n  return {\n    data: {\n      disabled: disabled\n    },\n    props: _extends({\n      id: useItemId(index),\n      tabIndex: -1\n    }, props, {\n      ref: ref,\n      \"data-disabled\": disabled ? \"\" : undefined,\n      \"data-selected\": isSelected ? \"\" : undefined,\n      \"data-valuetext\": valueText,\n      onClick: composeEventHandlers(onClick, handleClick),\n      onDragStart: composeEventHandlers(onDragStart, handleDragStart),\n      onMouseDown: composeEventHandlers(onMouseDown, handleMouseDown),\n      onMouseEnter: composeEventHandlers(onMouseEnter, handleMouseEnter),\n      onMouseLeave: composeEventHandlers(onMouseLeave, handleMouseLeave),\n      onMouseMove: composeEventHandlers(onMouseMove, handleMouseMove),\n      onFocus: composeEventHandlers(onFocus, handleFocus),\n      onMouseUp: composeEventHandlers(onMouseUp, handleMouseUp)\n    })\n  };\n}\n/**\n * DropdownItem\n */\n\n\nvar DropdownItem = /*#__PURE__*/forwardRef(function (_ref5, forwardedRef) {\n  var _ref5$as = _ref5.as,\n      Comp = _ref5$as === void 0 ? \"div\" : _ref5$as,\n      rest = _objectWithoutPropertiesLoose(_ref5, _excluded4);\n\n  var _useDropdownItem = useDropdownItem(_extends({}, rest, {\n    ref: forwardedRef\n  })),\n      props = _useDropdownItem.props;\n\n  return /*#__PURE__*/createElement(Comp, _extends({\n    \"data-reach-dropdown-item\": \"\"\n  }, props));\n});\n\nif (process.env.NODE_ENV !== \"production\") {\n  DropdownItem.displayName = \"DropdownItem\";\n} ////////////////////////////////////////////////////////////////////////////////\n\n\nfunction useDropdownItems(_ref6) {\n  _ref6.id;\n\n  var onKeyDown = _ref6.onKeyDown,\n      forwardedRef = _ref6.ref,\n      props = _objectWithoutPropertiesLoose(_ref6, _excluded5);\n\n  var _useDropdownContext3 = useDropdownContext(),\n      dispatch = _useDropdownContext3.dispatch,\n      triggerRef = _useDropdownContext3.triggerRef,\n      dropdownRef = _useDropdownContext3.dropdownRef,\n      selectCallbacks = _useDropdownContext3.selectCallbacks,\n      dropdownId = _useDropdownContext3.dropdownId,\n      _useDropdownContext3$ = _useDropdownContext3.state,\n      isExpanded = _useDropdownContext3$.isExpanded,\n      triggerId = _useDropdownContext3$.triggerId,\n      selectionIndex = _useDropdownContext3$.selectionIndex,\n      typeaheadQuery = _useDropdownContext3$.typeaheadQuery;\n\n  var items = useDropdownDescendants();\n  var ref = useComposedRefs(dropdownRef, forwardedRef);\n  useEffect(function () {\n    // Respond to user char key input with typeahead\n    var match = findItemFromTypeahead(items, typeaheadQuery);\n\n    if (typeaheadQuery && match != null) {\n      dispatch({\n        type: SELECT_ITEM_AT_INDEX,\n        payload: {\n          index: match,\n          dropdownRef: dropdownRef\n        }\n      });\n    }\n\n    var timeout = window.setTimeout(function () {\n      return typeaheadQuery && dispatch({\n        type: SEARCH_FOR_ITEM,\n        payload: \"\"\n      });\n    }, 1000);\n    return function () {\n      return window.clearTimeout(timeout);\n    };\n  }, [dispatch, items, typeaheadQuery, dropdownRef]);\n  var prevItemsLength = usePrevious(items.length);\n  var prevSelected = usePrevious(items[selectionIndex]);\n  var prevSelectionIndex = usePrevious(selectionIndex);\n  useEffect(function () {\n    if (selectionIndex > items.length - 1) {\n      // If for some reason our selection index is larger than our possible\n      // index range (let's say the last item is selected and the list\n      // dynamically updates), we need to select the last item in the list.\n      dispatch({\n        type: SELECT_ITEM_AT_INDEX,\n        payload: {\n          index: items.length - 1,\n          dropdownRef: dropdownRef\n        }\n      });\n    } else if ( // Checks if\n    //  - item length has changed\n    //  - selection index has not changed BUT selected item has changed\n    //\n    // This prevents any dynamic adding/removing of items from actually\n    // changing a user's expected selection.\n    prevItemsLength !== items.length && selectionIndex > -1 && prevSelected && prevSelectionIndex === selectionIndex && items[selectionIndex] !== prevSelected) {\n      dispatch({\n        type: SELECT_ITEM_AT_INDEX,\n        payload: {\n          index: items.findIndex(function (i) {\n            return i.key === (prevSelected == null ? void 0 : prevSelected.key);\n          }),\n          dropdownRef: dropdownRef\n        }\n      });\n    }\n  }, [dropdownRef, dispatch, items, prevItemsLength, prevSelected, prevSelectionIndex, selectionIndex]);\n  var handleKeyDown = composeEventHandlers(function handleKeyDown(event) {\n    var key = event.key;\n\n    if (!isExpanded) {\n      return;\n    }\n\n    switch (key) {\n      case \"Enter\":\n      case \" \":\n        var selected = items.find(function (item) {\n          return item.index === selectionIndex;\n        }); // For links, the Enter key will trigger a click by default, but for\n        // consistent behavior across items we'll trigger a click when the\n        // spacebar is pressed.\n\n        if (selected && !selected.disabled) {\n          event.preventDefault();\n\n          if (selected.isLink && selected.element) {\n            selected.element.click();\n          } else {\n            // Focus the button first by default when an item is selected.\n            // We fire the onSelect callback next so the app can manage\n            // focus if needed.\n            focus(triggerRef.current);\n            selectCallbacks.current[selected.index] && selectCallbacks.current[selected.index]();\n            dispatch({\n              type: CLICK_MENU_ITEM\n            });\n          }\n        }\n\n        break;\n\n      case \"Escape\":\n        focus(triggerRef.current);\n        dispatch({\n          type: CLOSE_MENU\n        });\n        break;\n\n      case \"Tab\":\n        // prevent leaving\n        event.preventDefault();\n        break;\n\n      default:\n        // Check if a user is typing some char keys and respond by setting\n        // the query state.\n        if (isString(key) && key.length === 1) {\n          var query = typeaheadQuery + key.toLowerCase();\n          dispatch({\n            type: SEARCH_FOR_ITEM,\n            payload: query\n          });\n        }\n\n        break;\n    }\n  }, useDescendantKeyDown(DropdownDescendantContext, {\n    currentIndex: selectionIndex,\n    orientation: \"vertical\",\n    rotate: false,\n    filter: function filter(item) {\n      return !item.disabled;\n    },\n    callback: function callback(index) {\n      dispatch({\n        type: SELECT_ITEM_AT_INDEX,\n        payload: {\n          index: index,\n          dropdownRef: dropdownRef\n        }\n      });\n    },\n    key: \"index\"\n  }));\n  return {\n    data: {\n      activeDescendant: useItemId(selectionIndex) || undefined,\n      triggerId: triggerId\n    },\n    props: _extends({\n      tabIndex: -1\n    }, props, {\n      ref: ref,\n      id: dropdownId,\n      onKeyDown: composeEventHandlers(onKeyDown, handleKeyDown)\n    })\n  };\n}\n/**\n * DropdownItem\n */\n\n\nvar DropdownItems = /*#__PURE__*/forwardRef(function (_ref7, forwardedRef) {\n  var _ref7$as = _ref7.as,\n      Comp = _ref7$as === void 0 ? \"div\" : _ref7$as,\n      rest = _objectWithoutPropertiesLoose(_ref7, _excluded6);\n\n  var _useDropdownItems = useDropdownItems(_extends({}, rest, {\n    ref: forwardedRef\n  })),\n      props = _useDropdownItems.props;\n\n  return /*#__PURE__*/createElement(Comp, _extends({\n    \"data-reach-dropdown-items\": \"\"\n  }, props));\n});\n\nif (process.env.NODE_ENV !== \"production\") {\n  DropdownItems.displayName = \"DropdownItems\";\n} ////////////////////////////////////////////////////////////////////////////////\n\n\nfunction useDropdownPopover(_ref8) {\n  var onBlur = _ref8.onBlur,\n      _ref8$portal = _ref8.portal,\n      portal = _ref8$portal === void 0 ? true : _ref8$portal,\n      position = _ref8.position,\n      forwardedRef = _ref8.ref,\n      props = _objectWithoutPropertiesLoose(_ref8, _excluded7);\n\n  var _useDropdownContext4 = useDropdownContext(),\n      triggerRef = _useDropdownContext4.triggerRef,\n      triggerClickedRef = _useDropdownContext4.triggerClickedRef,\n      dispatch = _useDropdownContext4.dispatch,\n      dropdownRef = _useDropdownContext4.dropdownRef,\n      popoverRef = _useDropdownContext4.popoverRef,\n      isExpanded = _useDropdownContext4.state.isExpanded;\n\n  var ref = useComposedRefs(popoverRef, forwardedRef);\n  useEffect(function () {\n    if (!isExpanded) {\n      return;\n    }\n\n    var ownerDocument = getOwnerDocument(popoverRef.current);\n\n    function listener(event) {\n      if (triggerClickedRef.current) {\n        triggerClickedRef.current = false;\n      } else if (!popoverContainsEventTarget(popoverRef.current, event.target)) {\n        // We on want to close only if focus rests outside the dropdown\n        dispatch({\n          type: CLOSE_MENU\n        });\n      }\n    }\n\n    ownerDocument.addEventListener(\"mousedown\", listener); // see https://github.com/reach/reach-ui/pull/700#discussion_r530369265\n    // ownerDocument.addEventListener(\"touchstart\", listener);\n\n    return function () {\n      ownerDocument.removeEventListener(\"mousedown\", listener); // ownerDocument.removeEventListener(\"touchstart\", listener);\n    };\n  }, [triggerClickedRef, triggerRef, dispatch, dropdownRef, popoverRef, isExpanded]);\n  return {\n    data: {\n      portal: portal,\n      position: position,\n      targetRef: triggerRef,\n      isExpanded: isExpanded\n    },\n    props: _extends({\n      ref: ref,\n      hidden: !isExpanded,\n      onBlur: composeEventHandlers(onBlur, function (event) {\n        if (event.currentTarget.contains(event.relatedTarget)) {\n          return;\n        }\n\n        dispatch({\n          type: CLOSE_MENU\n        });\n      })\n    }, props)\n  };\n}\n\nvar DropdownPopover = /*#__PURE__*/forwardRef(function (_ref9, forwardedRef) {\n  var _ref9$as = _ref9.as,\n      Comp = _ref9$as === void 0 ? \"div\" : _ref9$as,\n      rest = _objectWithoutPropertiesLoose(_ref9, _excluded8);\n\n  var _useDropdownPopover = useDropdownPopover(_extends({}, rest, {\n    ref: forwardedRef\n  })),\n      _useDropdownPopover$d = _useDropdownPopover.data,\n      portal = _useDropdownPopover$d.portal,\n      targetRef = _useDropdownPopover$d.targetRef,\n      position = _useDropdownPopover$d.position,\n      props = _useDropdownPopover.props;\n\n  var sharedProps = {\n    \"data-reach-dropdown-popover\": \"\"\n  };\n  return portal ? /*#__PURE__*/createElement(Popover, _extends({}, props, sharedProps, {\n    as: Comp,\n    targetRef: targetRef,\n    position: position\n  })) : /*#__PURE__*/createElement(Comp, _extends({}, props, sharedProps));\n});\n\nif (process.env.NODE_ENV !== \"production\") {\n  DropdownPopover.displayName = \"DropdownPopover\";\n} ////////////////////////////////////////////////////////////////////////////////\n\n/**\n * When a user's typed input matches the string displayed in an item, it is\n * expected that the matching item is selected. This is our matching function.\n */\n\n\nfunction findItemFromTypeahead(items, string) {\n  if (string === void 0) {\n    string = \"\";\n  }\n\n  if (!string) {\n    return null;\n  }\n\n  var found = items.find(function (item) {\n    var _item$element, _item$element$dataset, _item$element$dataset2;\n\n    return item.disabled ? false : (_item$element = item.element) == null ? void 0 : (_item$element$dataset = _item$element.dataset) == null ? void 0 : (_item$element$dataset2 = _item$element$dataset.valuetext) == null ? void 0 : _item$element$dataset2.toLowerCase().startsWith(string);\n  });\n  return found ? items.indexOf(found) : null;\n}\n\nfunction useItemId(index) {\n  var _React$useContext = useContext(DropdownContext),\n      dropdownId = _React$useContext.dropdownId;\n\n  return index != null && index > -1 ? makeId(\"option-\" + index, dropdownId) : undefined;\n}\n\nfunction focus(element) {\n  element && element.focus();\n}\n\nfunction popoverContainsEventTarget(popover, target) {\n  return !!(popover && popover.contains(target));\n}\n\nfunction reducer(state, action) {\n  if (action === void 0) {\n    action = {};\n  }\n\n  switch (action.type) {\n    case CLICK_MENU_ITEM:\n      return _extends({}, state, {\n        isExpanded: false,\n        selectionIndex: -1\n      });\n\n    case CLOSE_MENU:\n      return _extends({}, state, {\n        isExpanded: false,\n        selectionIndex: -1\n      });\n\n    case OPEN_MENU_AT_FIRST_ITEM:\n      return _extends({}, state, {\n        isExpanded: true,\n        selectionIndex: 0\n      });\n\n    case OPEN_MENU_AT_INDEX:\n      return _extends({}, state, {\n        isExpanded: true,\n        selectionIndex: action.payload.index\n      });\n\n    case OPEN_MENU_CLEARED:\n      return _extends({}, state, {\n        isExpanded: true,\n        selectionIndex: -1\n      });\n\n    case SELECT_ITEM_AT_INDEX:\n      {\n        var _action$payload$dropd = action.payload.dropdownRef,\n            dropdownRef = _action$payload$dropd === void 0 ? {\n          current: null\n        } : _action$payload$dropd;\n\n        if (action.payload.index >= 0 && action.payload.index !== state.selectionIndex) {\n          if (dropdownRef.current) {\n            var doc = getOwnerDocument(dropdownRef.current);\n\n            if (dropdownRef.current !== (doc == null ? void 0 : doc.activeElement)) {\n              dropdownRef.current.focus();\n            }\n          }\n\n          return _extends({}, state, {\n            selectionIndex: action.payload.max != null ? Math.min(Math.max(action.payload.index, 0), action.payload.max) : Math.max(action.payload.index, 0)\n          });\n        }\n\n        return state;\n      }\n\n    case CLEAR_SELECTION_INDEX:\n      return _extends({}, state, {\n        selectionIndex: -1\n      });\n\n    case SET_BUTTON_ID:\n      return _extends({}, state, {\n        triggerId: action.payload\n      });\n\n    case SEARCH_FOR_ITEM:\n      if (typeof action.payload !== \"undefined\") {\n        return _extends({}, state, {\n          typeaheadQuery: action.payload\n        });\n      }\n\n      return state;\n\n    default:\n      return state;\n  }\n}\n\nfunction useDropdownContext() {\n  return useContext(DropdownContext);\n}\n\nfunction useDropdownDescendants() {\n  return useDescendants(DropdownDescendantContext);\n} ////////////////////////////////////////////////////////////////////////////////\n\n\nexport { DropdownItem, DropdownItems, DropdownPopover, DropdownProvider, DropdownTrigger, useDropdownContext, useDropdownDescendants, useDropdownItem, useDropdownItems, useDropdownPopover, useDropdownTrigger };","map":{"version":3,"sources":["/Users/tomoliveira/Desktop/poke/frontend/node_modules/@reach/dropdown/dist/reach-dropdown.esm.js"],"names":["useRef","useReducer","useEffect","createElement","useContext","useMemo","forwardRef","useState","useCallback","useId","Popover","createDescendantContext","useDescendantsInit","DescendantProvider","useDescendants","useDescendant","useDescendantKeyDown","isRightClick","usePrevious","getOwnerDocument","createNamedContext","isFunction","isString","makeId","useStatefulRefValue","useComposedRefs","composeEventHandlers","_objectWithoutPropertiesLoose","source","excluded","target","sourceKeys","Object","keys","key","i","length","indexOf","_extends","assign","arguments","prototype","hasOwnProperty","call","apply","_excluded","_excluded2","_excluded3","_excluded4","_excluded5","_excluded6","_excluded7","_excluded8","CLEAR_SELECTION_INDEX","CLICK_MENU_ITEM","CLOSE_MENU","OPEN_MENU_AT_FIRST_ITEM","OPEN_MENU_AT_INDEX","OPEN_MENU_CLEARED","SEARCH_FOR_ITEM","SELECT_ITEM_AT_INDEX","SET_BUTTON_ID","DropdownDescendantContext","DropdownContext","initialState","triggerId","isExpanded","typeaheadQuery","selectionIndex","DropdownProvider","_ref","id","children","triggerRef","dropdownRef","popoverRef","_useDescendantsInit","descendants","setDescendants","_id","dropdownId","_React$useReducer","reducer","state","dispatch","triggerClickedRef","selectCallbacks","readyToSelect","mouseDownStartPosRef","x","y","context","window","__REACH_DISABLE_TOOLTIPS","requestAnimationFrame","focus","current","items","set","Provider","value","isOpen","process","env","NODE_ENV","displayName","useDropdownTrigger","_ref2","onKeyDown","onMouseDown","forwardedRef","ref","props","_useDropdownContext","useDropdownContext","_useDropdownContext$s","useDropdownDescendants","firstNonDisabledIndex","findIndex","item","disabled","type","payload","handleKeyDown","event","preventDefault","index","handleMouseDown","nativeEvent","clientX","clientY","data","controls","undefined","DropdownTrigger","_ref3","_ref3$as","as","Comp","rest","_useDropdownTrigger","useDropdownItem","_ref4","indexProp","_ref4$isLink","isLink","onClick","onDragStart","onMouseEnter","onMouseLeave","onMouseMove","onMouseUp","onSelect","onFocus","valueTextProp","valueText","_useDropdownContext2","_useDropdownContext2$","ownRef","_React$useState","setValueText","setValueTextFromDOM","node","textContent","mouseEventStarted","_useStatefulRefValue","element","handleRefSet","descendant","isSelected","select","handleClick","handleDragStart","handleMouseEnter","doc","activeElement","handleMouseLeave","handleMouseMove","threshold","deltaX","Math","abs","deltaY","handleFocus","handleMouseUp","click","setTimeout","clearTimeout","ownerDocument","addEventListener","listener","removeEventListener","useItemId","tabIndex","DropdownItem","_ref5","_ref5$as","_useDropdownItem","useDropdownItems","_ref6","_useDropdownContext3","_useDropdownContext3$","match","findItemFromTypeahead","timeout","prevItemsLength","prevSelected","prevSelectionIndex","selected","find","query","toLowerCase","currentIndex","orientation","rotate","filter","callback","activeDescendant","DropdownItems","_ref7","_ref7$as","_useDropdownItems","useDropdownPopover","_ref8","onBlur","_ref8$portal","portal","position","_useDropdownContext4","popoverContainsEventTarget","targetRef","hidden","currentTarget","contains","relatedTarget","DropdownPopover","_ref9","_ref9$as","_useDropdownPopover","_useDropdownPopover$d","sharedProps","string","found","_item$element","_item$element$dataset","_item$element$dataset2","dataset","valuetext","startsWith","_React$useContext","popover","action","_action$payload$dropd","max","min"],"mappings":"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","sourcesContent":["import { useRef, useReducer, useEffect, createElement, useContext, useMemo, forwardRef, useState, useCallback } from 'react';\nimport { useId } from '@reach/auto-id';\nimport { Popover } from '@reach/popover';\nimport { createDescendantContext, useDescendantsInit, DescendantProvider, useDescendants, useDescendant, useDescendantKeyDown } from '@reach/descendants';\nimport { isRightClick } from '@reach/utils/is-right-click';\nimport { usePrevious } from '@reach/utils/use-previous';\nimport { getOwnerDocument } from '@reach/utils/owner-document';\nimport { createNamedContext } from '@reach/utils/context';\nimport { isFunction, isString } from '@reach/utils/type-check';\nimport { makeId } from '@reach/utils/make-id';\nimport { useStatefulRefValue } from '@reach/utils/use-stateful-ref-value';\nimport { useComposedRefs } from '@reach/utils/compose-refs';\nimport { composeEventHandlers } from '@reach/utils/compose-event-handlers';\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nvar _excluded = [\"onKeyDown\", \"onMouseDown\", \"id\", \"ref\"],\n    _excluded2 = [\"as\"],\n    _excluded3 = [\"index\", \"isLink\", \"onClick\", \"onDragStart\", \"onMouseDown\", \"onMouseEnter\", \"onMouseLeave\", \"onMouseMove\", \"onMouseUp\", \"onSelect\", \"disabled\", \"onFocus\", \"valueText\", \"ref\"],\n    _excluded4 = [\"as\"],\n    _excluded5 = [\"id\", \"onKeyDown\", \"ref\"],\n    _excluded6 = [\"as\"],\n    _excluded7 = [\"onBlur\", \"portal\", \"position\", \"ref\"],\n    _excluded8 = [\"as\"];\n////////////////////////////////////////////////////////////////////////////////\n// Actions\nvar CLEAR_SELECTION_INDEX = \"CLEAR_SELECTION_INDEX\";\nvar CLICK_MENU_ITEM = \"CLICK_MENU_ITEM\";\nvar CLOSE_MENU = \"CLOSE_MENU\";\nvar OPEN_MENU_AT_FIRST_ITEM = \"OPEN_MENU_AT_FIRST_ITEM\";\nvar OPEN_MENU_AT_INDEX = \"OPEN_MENU_AT_INDEX\";\nvar OPEN_MENU_CLEARED = \"OPEN_MENU_CLEARED\";\nvar SEARCH_FOR_ITEM = \"SEARCH_FOR_ITEM\";\nvar SELECT_ITEM_AT_INDEX = \"SELECT_ITEM_AT_INDEX\";\nvar SET_BUTTON_ID = \"SET_BUTTON_ID\";\nvar DropdownDescendantContext = /*#__PURE__*/createDescendantContext(\"DropdownDescendantContext\");\nvar DropdownContext = /*#__PURE__*/createNamedContext(\"DropdownContext\", {});\nvar initialState = {\n  // The button ID is needed for aria controls and can be set directly and\n  // updated for top-level use via context. Otherwise a default is set by useId.\n  // TODO: Consider deprecating direct ID in 1.0 in favor of id at the top level\n  //       for passing deterministic IDs to descendent components.\n  triggerId: null,\n  // Whether or not the dropdown is expanded\n  isExpanded: false,\n  // When a user begins typing a character string, the selection will change if\n  // a matching item is found\n  typeaheadQuery: \"\",\n  // The index of the current selected item. When the selection is cleared a\n  // value of -1 is used.\n  selectionIndex: -1\n}; ////////////////////////////////////////////////////////////////////////////////\n// Dropdown!\n\nvar DropdownProvider = function DropdownProvider(_ref) {\n  var id = _ref.id,\n      children = _ref.children;\n  var triggerRef = useRef(null);\n  var dropdownRef = useRef(null);\n  var popoverRef = useRef(null);\n\n  var _useDescendantsInit = useDescendantsInit(),\n      descendants = _useDescendantsInit[0],\n      setDescendants = _useDescendantsInit[1];\n\n  var _id = useId(id);\n\n  var dropdownId = id || makeId(\"menu\", _id);\n  var triggerId = makeId(\"menu-button\", dropdownId);\n\n  var _React$useReducer = useReducer(reducer, _extends({}, initialState, {\n    triggerId: triggerId\n  })),\n      state = _React$useReducer[0],\n      dispatch = _React$useReducer[1]; // We use an event listener attached to the window to capture outside clicks\n  // that close the dropdown. We don't want the initial button click to trigger\n  // this when a dropdown is closed, so we can track this behavior in a ref for\n  // now. We shouldn't need this when we rewrite with state machine logic.\n\n\n  var triggerClickedRef = useRef(false); // We will put children callbacks in a ref to avoid triggering endless render\n  // loops when using render props if the app code doesn't useCallback\n  // https://github.com/reach/reach-ui/issues/523\n\n  var selectCallbacks = useRef([]); // If the popover's position overlaps with an option when the popover\n  // initially opens, the mouseup event will trigger a select. To prevent that,\n  // we decide the control is only ready to make a selection if the pointer\n  // moves a certain distance OR if the mouse button is pressed for a certain\n  // length of time, otherwise the user is just registering the initial button\n  // click rather than selecting an item.\n  // For context on some implementation details, see https://github.com/reach/reach-ui/issues/563\n\n  var readyToSelect = useRef(false);\n  var mouseDownStartPosRef = useRef({\n    x: 0,\n    y: 0\n  }); // Trying a new approach for splitting up contexts by stable/unstable\n  // references. We'll see how it goes!\n\n  var context = {\n    dispatch: dispatch,\n    dropdownId: dropdownId,\n    dropdownRef: dropdownRef,\n    mouseDownStartPosRef: mouseDownStartPosRef,\n    popoverRef: popoverRef,\n    readyToSelect: readyToSelect,\n    selectCallbacks: selectCallbacks,\n    state: state,\n    triggerClickedRef: triggerClickedRef,\n    triggerRef: triggerRef\n  }; // When the dropdown is open, focus is placed on the dropdown itself so that\n  // keyboard navigation is still possible.\n\n  useEffect(function () {\n    if (state.isExpanded) {\n      // @ts-ignore\n      window.__REACH_DISABLE_TOOLTIPS = true;\n      window.requestAnimationFrame(function () {\n        focus(dropdownRef.current);\n      });\n    } else {\n      // We want to ignore the immediate focus of a tooltip so it doesn't pop up\n      // again when the dropdown closes, only pops up when focus returns again\n      // to the tooltip (like native OS tooltips).\n      // @ts-ignore\n      window.__REACH_DISABLE_TOOLTIPS = false;\n    }\n  }, [state.isExpanded]);\n  return /*#__PURE__*/createElement(DescendantProvider, {\n    context: DropdownDescendantContext,\n    items: descendants,\n    set: setDescendants\n  }, /*#__PURE__*/createElement(DropdownContext.Provider, {\n    value: context\n  }, isFunction(children) ? children({\n    isExpanded: state.isExpanded,\n    // TODO: Remove in 1.0\n    isOpen: state.isExpanded\n  }) : children));\n};\n\nif (process.env.NODE_ENV !== \"production\") {\n  DropdownProvider.displayName = \"DropdownProvider\";\n} ////////////////////////////////////////////////////////////////////////////////\n\n\nfunction useDropdownTrigger(_ref2) {\n  var onKeyDown = _ref2.onKeyDown,\n      onMouseDown = _ref2.onMouseDown,\n      id = _ref2.id,\n      forwardedRef = _ref2.ref,\n      props = _objectWithoutPropertiesLoose(_ref2, _excluded);\n\n  var _useDropdownContext = useDropdownContext(),\n      dispatch = _useDropdownContext.dispatch,\n      dropdownId = _useDropdownContext.dropdownId,\n      mouseDownStartPosRef = _useDropdownContext.mouseDownStartPosRef,\n      triggerClickedRef = _useDropdownContext.triggerClickedRef,\n      triggerRef = _useDropdownContext.triggerRef,\n      _useDropdownContext$s = _useDropdownContext.state,\n      triggerId = _useDropdownContext$s.triggerId,\n      isExpanded = _useDropdownContext$s.isExpanded;\n\n  var ref = useComposedRefs(triggerRef, forwardedRef);\n  var items = useDropdownDescendants();\n  var firstNonDisabledIndex = useMemo(function () {\n    return items.findIndex(function (item) {\n      return !item.disabled;\n    });\n  }, [items]);\n  useEffect(function () {\n    if (id != null && id !== triggerId) {\n      dispatch({\n        type: SET_BUTTON_ID,\n        payload: id\n      });\n    }\n  }, [triggerId, dispatch, id]);\n\n  function handleKeyDown(event) {\n    switch (event.key) {\n      case \"ArrowDown\":\n      case \"ArrowUp\":\n        event.preventDefault(); // prevent scroll\n\n        dispatch({\n          type: OPEN_MENU_AT_INDEX,\n          payload: {\n            index: firstNonDisabledIndex\n          }\n        });\n        break;\n\n      case \"Enter\":\n      case \" \":\n        dispatch({\n          type: OPEN_MENU_AT_INDEX,\n          payload: {\n            index: firstNonDisabledIndex\n          }\n        });\n        break;\n    }\n  }\n\n  function handleMouseDown(event) {\n    if (isRightClick(event.nativeEvent)) {\n      return;\n    }\n\n    mouseDownStartPosRef.current = {\n      x: event.clientX,\n      y: event.clientY\n    };\n\n    if (!isExpanded) {\n      triggerClickedRef.current = true;\n    }\n\n    if (isExpanded) {\n      dispatch({\n        type: CLOSE_MENU\n      });\n    } else {\n      dispatch({\n        type: OPEN_MENU_CLEARED\n      });\n    }\n  }\n\n  return {\n    data: {\n      isExpanded: isExpanded,\n      controls: dropdownId\n    },\n    props: _extends({}, props, {\n      ref: ref,\n      id: triggerId || undefined,\n      onKeyDown: composeEventHandlers(onKeyDown, handleKeyDown),\n      onMouseDown: composeEventHandlers(onMouseDown, handleMouseDown),\n      type: \"button\"\n    })\n  };\n}\n\nvar DropdownTrigger = /*#__PURE__*/forwardRef(function (_ref3, forwardedRef) {\n  var _ref3$as = _ref3.as,\n      Comp = _ref3$as === void 0 ? \"button\" : _ref3$as,\n      rest = _objectWithoutPropertiesLoose(_ref3, _excluded2);\n\n  var _useDropdownTrigger = useDropdownTrigger(_extends({}, rest, {\n    ref: forwardedRef\n  })),\n      props = _useDropdownTrigger.props;\n\n  return /*#__PURE__*/createElement(Comp, _extends({\n    \"data-reach-dropdown-trigger\": \"\"\n  }, props));\n});\n\nif (process.env.NODE_ENV !== \"production\") {\n  DropdownTrigger.displayName = \"DropdownTrigger\";\n} ////////////////////////////////////////////////////////////////////////////////\n\n\nfunction useDropdownItem(_ref4) {\n  var indexProp = _ref4.index,\n      _ref4$isLink = _ref4.isLink,\n      isLink = _ref4$isLink === void 0 ? false : _ref4$isLink,\n      onClick = _ref4.onClick,\n      onDragStart = _ref4.onDragStart,\n      onMouseDown = _ref4.onMouseDown,\n      onMouseEnter = _ref4.onMouseEnter,\n      onMouseLeave = _ref4.onMouseLeave,\n      onMouseMove = _ref4.onMouseMove,\n      onMouseUp = _ref4.onMouseUp,\n      onSelect = _ref4.onSelect,\n      disabled = _ref4.disabled,\n      onFocus = _ref4.onFocus,\n      valueTextProp = _ref4.valueText,\n      forwardedRef = _ref4.ref,\n      props = _objectWithoutPropertiesLoose(_ref4, _excluded3);\n\n  var _useDropdownContext2 = useDropdownContext(),\n      dispatch = _useDropdownContext2.dispatch,\n      dropdownRef = _useDropdownContext2.dropdownRef,\n      mouseDownStartPosRef = _useDropdownContext2.mouseDownStartPosRef,\n      readyToSelect = _useDropdownContext2.readyToSelect,\n      selectCallbacks = _useDropdownContext2.selectCallbacks,\n      triggerRef = _useDropdownContext2.triggerRef,\n      _useDropdownContext2$ = _useDropdownContext2.state,\n      selectionIndex = _useDropdownContext2$.selectionIndex,\n      isExpanded = _useDropdownContext2$.isExpanded;\n\n  var ownRef = useRef(null); // After the ref is mounted to the DOM node, we check to see if we have an\n  // explicit valueText prop before looking for the node's textContent for\n  // typeahead functionality.\n\n  var _React$useState = useState(valueTextProp || \"\"),\n      valueText = _React$useState[0],\n      setValueText = _React$useState[1];\n\n  var setValueTextFromDOM = useCallback(function (node) {\n    if (!valueTextProp && node != null && node.textContent) {\n      setValueText(node.textContent);\n    }\n  }, [valueTextProp]);\n  var mouseEventStarted = useRef(false);\n\n  var _useStatefulRefValue = useStatefulRefValue(ownRef, null),\n      element = _useStatefulRefValue[0],\n      handleRefSet = _useStatefulRefValue[1];\n\n  var descendant = useMemo(function () {\n    return {\n      element: element,\n      key: valueText,\n      disabled: disabled,\n      isLink: isLink\n    };\n  }, [disabled, element, isLink, valueText]);\n  var index = useDescendant(descendant, DropdownDescendantContext, indexProp);\n  var isSelected = index === selectionIndex && !disabled;\n  var ref = useComposedRefs(forwardedRef, handleRefSet, setValueTextFromDOM); // Update the callback ref array on every render\n\n  selectCallbacks.current[index] = onSelect;\n\n  function select() {\n    focus(triggerRef.current);\n    onSelect && onSelect();\n    dispatch({\n      type: CLICK_MENU_ITEM\n    });\n  }\n\n  function handleClick(event) {\n    if (isRightClick(event.nativeEvent)) {\n      return;\n    }\n\n    if (isLink) {\n      if (disabled) {\n        event.preventDefault();\n      } else {\n        select();\n      }\n    }\n  }\n\n  function handleDragStart(event) {\n    // Because we don't preventDefault on mousedown for links (we need the\n    // native click event), clicking and holding on a link triggers a\n    // dragstart which we don't want.\n    if (isLink) {\n      event.preventDefault();\n    }\n  }\n\n  function handleMouseDown(event) {\n    if (isRightClick(event.nativeEvent)) {\n      return;\n    }\n\n    if (isLink) {\n      // Signal that the mouse is down so we can call the right function if the\n      // user is clicking on a link.\n      mouseEventStarted.current = true;\n    } else {\n      event.preventDefault();\n    }\n  }\n\n  function handleMouseEnter(event) {\n    var doc = getOwnerDocument(dropdownRef.current);\n\n    if (!isSelected && index != null && !disabled) {\n      if (dropdownRef != null && dropdownRef.current && dropdownRef.current !== doc.activeElement && ownRef.current !== doc.activeElement) {\n        dropdownRef.current.focus();\n      }\n\n      dispatch({\n        type: SELECT_ITEM_AT_INDEX,\n        payload: {\n          index: index\n        }\n      });\n    }\n  }\n\n  function handleMouseLeave(event) {\n    // Clear out selection when mouse over a non-dropdown-item child.\n    dispatch({\n      type: CLEAR_SELECTION_INDEX\n    });\n  }\n\n  function handleMouseMove(event) {\n    if (!readyToSelect.current) {\n      var threshold = 8;\n      var deltaX = Math.abs(event.clientX - mouseDownStartPosRef.current.x);\n      var deltaY = Math.abs(event.clientY - mouseDownStartPosRef.current.y);\n\n      if (deltaX > threshold || deltaY > threshold) {\n        readyToSelect.current = true;\n      }\n    }\n\n    if (!isSelected && index != null && !disabled) {\n      dispatch({\n        type: SELECT_ITEM_AT_INDEX,\n        payload: {\n          index: index,\n          dropdownRef: dropdownRef\n        }\n      });\n    }\n  }\n\n  function handleFocus() {\n    readyToSelect.current = true;\n\n    if (!isSelected && index != null && !disabled) {\n      dispatch({\n        type: SELECT_ITEM_AT_INDEX,\n        payload: {\n          index: index\n        }\n      });\n    }\n  }\n\n  function handleMouseUp(event) {\n    if (isRightClick(event.nativeEvent)) {\n      return;\n    }\n\n    if (!readyToSelect.current) {\n      readyToSelect.current = true;\n      return;\n    }\n\n    if (isLink) {\n      // If a mousedown event was initiated on a link item followed by a mouseup\n      // event on the same link, we do nothing; a click event will come next and\n      // handle selection. Otherwise, we trigger a click event.\n      if (mouseEventStarted.current) {\n        mouseEventStarted.current = false;\n      } else if (ownRef.current) {\n        ownRef.current.click();\n      }\n    } else {\n      if (!disabled) {\n        select();\n      }\n    }\n  }\n\n  useEffect(function () {\n    if (isExpanded) {\n      // When the dropdown opens, wait for about half a second before enabling\n      // selection. This is designed to mirror dropdown menus on macOS, where\n      // opening a menu on top of a trigger would otherwise result in an\n      // immediate accidental selection once the click trigger is released.\n      var id = window.setTimeout(function () {\n        readyToSelect.current = true;\n      }, 400);\n      return function () {\n        window.clearTimeout(id);\n      };\n    } else {\n      // When the dropdown closes, reset readyToSelect for the next interaction.\n      readyToSelect.current = false;\n    }\n  }, [isExpanded, readyToSelect]); // Any time a mouseup event occurs anywhere in the document, we reset the\n  // mouseEventStarted ref so we can check it again when needed.\n\n  useEffect(function () {\n    var ownerDocument = getOwnerDocument(ownRef.current);\n    ownerDocument.addEventListener(\"mouseup\", listener);\n    return function () {\n      ownerDocument.removeEventListener(\"mouseup\", listener);\n    };\n\n    function listener() {\n      mouseEventStarted.current = false;\n    }\n  }, []);\n  return {\n    data: {\n      disabled: disabled\n    },\n    props: _extends({\n      id: useItemId(index),\n      tabIndex: -1\n    }, props, {\n      ref: ref,\n      \"data-disabled\": disabled ? \"\" : undefined,\n      \"data-selected\": isSelected ? \"\" : undefined,\n      \"data-valuetext\": valueText,\n      onClick: composeEventHandlers(onClick, handleClick),\n      onDragStart: composeEventHandlers(onDragStart, handleDragStart),\n      onMouseDown: composeEventHandlers(onMouseDown, handleMouseDown),\n      onMouseEnter: composeEventHandlers(onMouseEnter, handleMouseEnter),\n      onMouseLeave: composeEventHandlers(onMouseLeave, handleMouseLeave),\n      onMouseMove: composeEventHandlers(onMouseMove, handleMouseMove),\n      onFocus: composeEventHandlers(onFocus, handleFocus),\n      onMouseUp: composeEventHandlers(onMouseUp, handleMouseUp)\n    })\n  };\n}\n/**\n * DropdownItem\n */\n\n\nvar DropdownItem = /*#__PURE__*/forwardRef(function (_ref5, forwardedRef) {\n  var _ref5$as = _ref5.as,\n      Comp = _ref5$as === void 0 ? \"div\" : _ref5$as,\n      rest = _objectWithoutPropertiesLoose(_ref5, _excluded4);\n\n  var _useDropdownItem = useDropdownItem(_extends({}, rest, {\n    ref: forwardedRef\n  })),\n      props = _useDropdownItem.props;\n\n  return /*#__PURE__*/createElement(Comp, _extends({\n    \"data-reach-dropdown-item\": \"\"\n  }, props));\n});\n\nif (process.env.NODE_ENV !== \"production\") {\n  DropdownItem.displayName = \"DropdownItem\";\n} ////////////////////////////////////////////////////////////////////////////////\n\n\nfunction useDropdownItems(_ref6) {\n  _ref6.id;\n      var onKeyDown = _ref6.onKeyDown,\n      forwardedRef = _ref6.ref,\n      props = _objectWithoutPropertiesLoose(_ref6, _excluded5);\n\n  var _useDropdownContext3 = useDropdownContext(),\n      dispatch = _useDropdownContext3.dispatch,\n      triggerRef = _useDropdownContext3.triggerRef,\n      dropdownRef = _useDropdownContext3.dropdownRef,\n      selectCallbacks = _useDropdownContext3.selectCallbacks,\n      dropdownId = _useDropdownContext3.dropdownId,\n      _useDropdownContext3$ = _useDropdownContext3.state,\n      isExpanded = _useDropdownContext3$.isExpanded,\n      triggerId = _useDropdownContext3$.triggerId,\n      selectionIndex = _useDropdownContext3$.selectionIndex,\n      typeaheadQuery = _useDropdownContext3$.typeaheadQuery;\n\n  var items = useDropdownDescendants();\n  var ref = useComposedRefs(dropdownRef, forwardedRef);\n  useEffect(function () {\n    // Respond to user char key input with typeahead\n    var match = findItemFromTypeahead(items, typeaheadQuery);\n\n    if (typeaheadQuery && match != null) {\n      dispatch({\n        type: SELECT_ITEM_AT_INDEX,\n        payload: {\n          index: match,\n          dropdownRef: dropdownRef\n        }\n      });\n    }\n\n    var timeout = window.setTimeout(function () {\n      return typeaheadQuery && dispatch({\n        type: SEARCH_FOR_ITEM,\n        payload: \"\"\n      });\n    }, 1000);\n    return function () {\n      return window.clearTimeout(timeout);\n    };\n  }, [dispatch, items, typeaheadQuery, dropdownRef]);\n  var prevItemsLength = usePrevious(items.length);\n  var prevSelected = usePrevious(items[selectionIndex]);\n  var prevSelectionIndex = usePrevious(selectionIndex);\n  useEffect(function () {\n    if (selectionIndex > items.length - 1) {\n      // If for some reason our selection index is larger than our possible\n      // index range (let's say the last item is selected and the list\n      // dynamically updates), we need to select the last item in the list.\n      dispatch({\n        type: SELECT_ITEM_AT_INDEX,\n        payload: {\n          index: items.length - 1,\n          dropdownRef: dropdownRef\n        }\n      });\n    } else if ( // Checks if\n    //  - item length has changed\n    //  - selection index has not changed BUT selected item has changed\n    //\n    // This prevents any dynamic adding/removing of items from actually\n    // changing a user's expected selection.\n    prevItemsLength !== items.length && selectionIndex > -1 && prevSelected && prevSelectionIndex === selectionIndex && items[selectionIndex] !== prevSelected) {\n      dispatch({\n        type: SELECT_ITEM_AT_INDEX,\n        payload: {\n          index: items.findIndex(function (i) {\n            return i.key === (prevSelected == null ? void 0 : prevSelected.key);\n          }),\n          dropdownRef: dropdownRef\n        }\n      });\n    }\n  }, [dropdownRef, dispatch, items, prevItemsLength, prevSelected, prevSelectionIndex, selectionIndex]);\n  var handleKeyDown = composeEventHandlers(function handleKeyDown(event) {\n    var key = event.key;\n\n    if (!isExpanded) {\n      return;\n    }\n\n    switch (key) {\n      case \"Enter\":\n      case \" \":\n        var selected = items.find(function (item) {\n          return item.index === selectionIndex;\n        }); // For links, the Enter key will trigger a click by default, but for\n        // consistent behavior across items we'll trigger a click when the\n        // spacebar is pressed.\n\n        if (selected && !selected.disabled) {\n          event.preventDefault();\n\n          if (selected.isLink && selected.element) {\n            selected.element.click();\n          } else {\n            // Focus the button first by default when an item is selected.\n            // We fire the onSelect callback next so the app can manage\n            // focus if needed.\n            focus(triggerRef.current);\n            selectCallbacks.current[selected.index] && selectCallbacks.current[selected.index]();\n            dispatch({\n              type: CLICK_MENU_ITEM\n            });\n          }\n        }\n\n        break;\n\n      case \"Escape\":\n        focus(triggerRef.current);\n        dispatch({\n          type: CLOSE_MENU\n        });\n        break;\n\n      case \"Tab\":\n        // prevent leaving\n        event.preventDefault();\n        break;\n\n      default:\n        // Check if a user is typing some char keys and respond by setting\n        // the query state.\n        if (isString(key) && key.length === 1) {\n          var query = typeaheadQuery + key.toLowerCase();\n          dispatch({\n            type: SEARCH_FOR_ITEM,\n            payload: query\n          });\n        }\n\n        break;\n    }\n  }, useDescendantKeyDown(DropdownDescendantContext, {\n    currentIndex: selectionIndex,\n    orientation: \"vertical\",\n    rotate: false,\n    filter: function filter(item) {\n      return !item.disabled;\n    },\n    callback: function callback(index) {\n      dispatch({\n        type: SELECT_ITEM_AT_INDEX,\n        payload: {\n          index: index,\n          dropdownRef: dropdownRef\n        }\n      });\n    },\n    key: \"index\"\n  }));\n  return {\n    data: {\n      activeDescendant: useItemId(selectionIndex) || undefined,\n      triggerId: triggerId\n    },\n    props: _extends({\n      tabIndex: -1\n    }, props, {\n      ref: ref,\n      id: dropdownId,\n      onKeyDown: composeEventHandlers(onKeyDown, handleKeyDown)\n    })\n  };\n}\n/**\n * DropdownItem\n */\n\n\nvar DropdownItems = /*#__PURE__*/forwardRef(function (_ref7, forwardedRef) {\n  var _ref7$as = _ref7.as,\n      Comp = _ref7$as === void 0 ? \"div\" : _ref7$as,\n      rest = _objectWithoutPropertiesLoose(_ref7, _excluded6);\n\n  var _useDropdownItems = useDropdownItems(_extends({}, rest, {\n    ref: forwardedRef\n  })),\n      props = _useDropdownItems.props;\n\n  return /*#__PURE__*/createElement(Comp, _extends({\n    \"data-reach-dropdown-items\": \"\"\n  }, props));\n});\n\nif (process.env.NODE_ENV !== \"production\") {\n  DropdownItems.displayName = \"DropdownItems\";\n} ////////////////////////////////////////////////////////////////////////////////\n\n\nfunction useDropdownPopover(_ref8) {\n  var onBlur = _ref8.onBlur,\n      _ref8$portal = _ref8.portal,\n      portal = _ref8$portal === void 0 ? true : _ref8$portal,\n      position = _ref8.position,\n      forwardedRef = _ref8.ref,\n      props = _objectWithoutPropertiesLoose(_ref8, _excluded7);\n\n  var _useDropdownContext4 = useDropdownContext(),\n      triggerRef = _useDropdownContext4.triggerRef,\n      triggerClickedRef = _useDropdownContext4.triggerClickedRef,\n      dispatch = _useDropdownContext4.dispatch,\n      dropdownRef = _useDropdownContext4.dropdownRef,\n      popoverRef = _useDropdownContext4.popoverRef,\n      isExpanded = _useDropdownContext4.state.isExpanded;\n\n  var ref = useComposedRefs(popoverRef, forwardedRef);\n  useEffect(function () {\n    if (!isExpanded) {\n      return;\n    }\n\n    var ownerDocument = getOwnerDocument(popoverRef.current);\n\n    function listener(event) {\n      if (triggerClickedRef.current) {\n        triggerClickedRef.current = false;\n      } else if (!popoverContainsEventTarget(popoverRef.current, event.target)) {\n        // We on want to close only if focus rests outside the dropdown\n        dispatch({\n          type: CLOSE_MENU\n        });\n      }\n    }\n\n    ownerDocument.addEventListener(\"mousedown\", listener); // see https://github.com/reach/reach-ui/pull/700#discussion_r530369265\n    // ownerDocument.addEventListener(\"touchstart\", listener);\n\n    return function () {\n      ownerDocument.removeEventListener(\"mousedown\", listener); // ownerDocument.removeEventListener(\"touchstart\", listener);\n    };\n  }, [triggerClickedRef, triggerRef, dispatch, dropdownRef, popoverRef, isExpanded]);\n  return {\n    data: {\n      portal: portal,\n      position: position,\n      targetRef: triggerRef,\n      isExpanded: isExpanded\n    },\n    props: _extends({\n      ref: ref,\n      hidden: !isExpanded,\n      onBlur: composeEventHandlers(onBlur, function (event) {\n        if (event.currentTarget.contains(event.relatedTarget)) {\n          return;\n        }\n\n        dispatch({\n          type: CLOSE_MENU\n        });\n      })\n    }, props)\n  };\n}\n\nvar DropdownPopover = /*#__PURE__*/forwardRef(function (_ref9, forwardedRef) {\n  var _ref9$as = _ref9.as,\n      Comp = _ref9$as === void 0 ? \"div\" : _ref9$as,\n      rest = _objectWithoutPropertiesLoose(_ref9, _excluded8);\n\n  var _useDropdownPopover = useDropdownPopover(_extends({}, rest, {\n    ref: forwardedRef\n  })),\n      _useDropdownPopover$d = _useDropdownPopover.data,\n      portal = _useDropdownPopover$d.portal,\n      targetRef = _useDropdownPopover$d.targetRef,\n      position = _useDropdownPopover$d.position,\n      props = _useDropdownPopover.props;\n\n  var sharedProps = {\n    \"data-reach-dropdown-popover\": \"\"\n  };\n  return portal ? /*#__PURE__*/createElement(Popover, _extends({}, props, sharedProps, {\n    as: Comp,\n    targetRef: targetRef,\n    position: position\n  })) : /*#__PURE__*/createElement(Comp, _extends({}, props, sharedProps));\n});\n\nif (process.env.NODE_ENV !== \"production\") {\n  DropdownPopover.displayName = \"DropdownPopover\";\n} ////////////////////////////////////////////////////////////////////////////////\n\n/**\n * When a user's typed input matches the string displayed in an item, it is\n * expected that the matching item is selected. This is our matching function.\n */\n\n\nfunction findItemFromTypeahead(items, string) {\n  if (string === void 0) {\n    string = \"\";\n  }\n\n  if (!string) {\n    return null;\n  }\n\n  var found = items.find(function (item) {\n    var _item$element, _item$element$dataset, _item$element$dataset2;\n\n    return item.disabled ? false : (_item$element = item.element) == null ? void 0 : (_item$element$dataset = _item$element.dataset) == null ? void 0 : (_item$element$dataset2 = _item$element$dataset.valuetext) == null ? void 0 : _item$element$dataset2.toLowerCase().startsWith(string);\n  });\n  return found ? items.indexOf(found) : null;\n}\n\nfunction useItemId(index) {\n  var _React$useContext = useContext(DropdownContext),\n      dropdownId = _React$useContext.dropdownId;\n\n  return index != null && index > -1 ? makeId(\"option-\" + index, dropdownId) : undefined;\n}\n\nfunction focus(element) {\n  element && element.focus();\n}\n\nfunction popoverContainsEventTarget(popover, target) {\n  return !!(popover && popover.contains(target));\n}\n\nfunction reducer(state, action) {\n  if (action === void 0) {\n    action = {};\n  }\n\n  switch (action.type) {\n    case CLICK_MENU_ITEM:\n      return _extends({}, state, {\n        isExpanded: false,\n        selectionIndex: -1\n      });\n\n    case CLOSE_MENU:\n      return _extends({}, state, {\n        isExpanded: false,\n        selectionIndex: -1\n      });\n\n    case OPEN_MENU_AT_FIRST_ITEM:\n      return _extends({}, state, {\n        isExpanded: true,\n        selectionIndex: 0\n      });\n\n    case OPEN_MENU_AT_INDEX:\n      return _extends({}, state, {\n        isExpanded: true,\n        selectionIndex: action.payload.index\n      });\n\n    case OPEN_MENU_CLEARED:\n      return _extends({}, state, {\n        isExpanded: true,\n        selectionIndex: -1\n      });\n\n    case SELECT_ITEM_AT_INDEX:\n      {\n        var _action$payload$dropd = action.payload.dropdownRef,\n            dropdownRef = _action$payload$dropd === void 0 ? {\n          current: null\n        } : _action$payload$dropd;\n\n        if (action.payload.index >= 0 && action.payload.index !== state.selectionIndex) {\n          if (dropdownRef.current) {\n            var doc = getOwnerDocument(dropdownRef.current);\n\n            if (dropdownRef.current !== (doc == null ? void 0 : doc.activeElement)) {\n              dropdownRef.current.focus();\n            }\n          }\n\n          return _extends({}, state, {\n            selectionIndex: action.payload.max != null ? Math.min(Math.max(action.payload.index, 0), action.payload.max) : Math.max(action.payload.index, 0)\n          });\n        }\n\n        return state;\n      }\n\n    case CLEAR_SELECTION_INDEX:\n      return _extends({}, state, {\n        selectionIndex: -1\n      });\n\n    case SET_BUTTON_ID:\n      return _extends({}, state, {\n        triggerId: action.payload\n      });\n\n    case SEARCH_FOR_ITEM:\n      if (typeof action.payload !== \"undefined\") {\n        return _extends({}, state, {\n          typeaheadQuery: action.payload\n        });\n      }\n\n      return state;\n\n    default:\n      return state;\n  }\n}\n\nfunction useDropdownContext() {\n  return useContext(DropdownContext);\n}\n\nfunction useDropdownDescendants() {\n  return useDescendants(DropdownDescendantContext);\n} ////////////////////////////////////////////////////////////////////////////////\n\nexport { DropdownItem, DropdownItems, DropdownPopover, DropdownProvider, DropdownTrigger, useDropdownContext, useDropdownDescendants, useDropdownItem, useDropdownItems, useDropdownPopover, useDropdownTrigger };\n"]},"metadata":{},"sourceType":"module"}